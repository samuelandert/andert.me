import{s as at,f as ct,a as lt,l as ut,g as ht,P as ft,c as pt,m as dt,j as gt,i as E,E as yt,n as wt,z as Q,d as N}from"./scheduler.530ffea1.js";import{S as vt,i as mt}from"./index.5e624b26.js";var _t=Object.defineProperty,bt=(r,e,n)=>e in r?_t(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,U=(r,e,n)=>(bt(r,typeof e!="symbol"?e+"":e,n),n),L=(r,e,n)=>{if(!e.has(r))throw TypeError("Cannot "+n)},H=(r,e,n)=>(L(r,e,"read from private field"),n?n.call(r):e.get(r)),R=(r,e,n)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,n)},X=(r,e,n,o)=>(L(r,e,"write to private field"),o?o.call(r,n):e.set(r,n),n),k=(r,e,n)=>(L(r,e,"access private method"),n),T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xt(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var n=function o(){if(this instanceof o){var p=[null];p.push.apply(p,arguments);var c=Function.bind.apply(e,p);return new c}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(o){var p=Object.getOwnPropertyDescriptor(r,o);Object.defineProperty(n,o,p.get?p:{enumerable:!0,get:function(){return r[o]}})}),n}var W={},St={get exports(){return W},set exports(r){W=r}};function Bt(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q={},kt={get exports(){return q},set exports(r){q=r}};const Ot={},At=Object.freeze(Object.defineProperty({__proto__:null,default:Ot},Symbol.toStringTag,{value:"Module"})),Ct=xt(At);var Z;function Y(){return Z||(Z=1,function(r,e){(function(n,o){r.exports=o()})(T,function(){var n=n||function(o,p){var c;if(typeof window<"u"&&window.crypto&&(c=window.crypto),typeof self<"u"&&self.crypto&&(c=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(c=globalThis.crypto),!c&&typeof window<"u"&&window.msCrypto&&(c=window.msCrypto),!c&&typeof T<"u"&&T.crypto&&(c=T.crypto),!c&&typeof Bt=="function")try{c=Ct}catch{}var S=function(){if(c){if(typeof c.getRandomValues=="function")try{return c.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof c.randomBytes=="function")try{return c.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function t(){}return function(i){var a;return t.prototype=i,a=new t,t.prototype=null,a}}(),h={},w=h.lib={},_=w.Base=function(){return{extend:function(t){var i=C(this);return t&&i.mixIn(t),(!i.hasOwnProperty("init")||this.init===i.init)&&(i.init=function(){i.$super.init.apply(this,arguments)}),i.init.prototype=i,i.$super=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),g=w.WordArray=_.extend({init:function(t,i){t=this.words=t||[],i!=p?this.sigBytes=i:this.sigBytes=t.length*4},toString:function(t){return(t||u).stringify(this)},concat:function(t){var i=this.words,a=t.words,l=this.sigBytes,y=t.sigBytes;if(this.clamp(),l%4)for(var m=0;m<y;m++){var b=a[m>>>2]>>>24-m%4*8&255;i[l+m>>>2]|=b<<24-(l+m)%4*8}else for(var x=0;x<y;x+=4)i[l+x>>>2]=a[x>>>2];return this.sigBytes+=y,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=o.ceil(i/4)},clone:function(){var t=_.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var i=[],a=0;a<t;a+=4)i.push(S());return new g.init(i,t)}}),v=h.enc={},u=v.Hex={stringify:function(t){for(var i=t.words,a=t.sigBytes,l=[],y=0;y<a;y++){var m=i[y>>>2]>>>24-y%4*8&255;l.push((m>>>4).toString(16)),l.push((m&15).toString(16))}return l.join("")},parse:function(t){for(var i=t.length,a=[],l=0;l<i;l+=2)a[l>>>3]|=parseInt(t.substr(l,2),16)<<24-l%8*4;return new g.init(a,i/2)}},d=v.Latin1={stringify:function(t){for(var i=t.words,a=t.sigBytes,l=[],y=0;y<a;y++){var m=i[y>>>2]>>>24-y%4*8&255;l.push(String.fromCharCode(m))}return l.join("")},parse:function(t){for(var i=t.length,a=[],l=0;l<i;l++)a[l>>>2]|=(t.charCodeAt(l)&255)<<24-l%4*8;return new g.init(a,i)}},s=v.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(t){return d.parse(unescape(encodeURIComponent(t)))}},f=w.BufferedBlockAlgorithm=_.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(t){typeof t=="string"&&(t=s.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var i,a=this._data,l=a.words,y=a.sigBytes,m=this.blockSize,b=m*4,x=y/b;t?x=o.ceil(x):x=o.max((x|0)-this._minBufferSize,0);var j=x*m,M=o.min(j*4,y);if(j){for(var $=0;$<j;$+=m)this._doProcessBlock(l,$);i=l.splice(0,j),a.sigBytes-=M}return new g.init(i,M)},clone:function(){var t=_.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});w.Hasher=f.extend({cfg:_.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){t&&this._append(t);var i=this._doFinalize();return i},blockSize:16,_createHelper:function(t){return function(i,a){return new t.init(a).finalize(i)}},_createHmacHelper:function(t){return function(i,a){return new B.HMAC.init(t,a).finalize(i)}}});var B=h.algo={};return h}(Math);return n})}(kt)),q}(function(r,e){(function(n,o){r.exports=o(Y())})(T,function(n){return function(){var o=n,p=o.lib,c=p.WordArray,S=o.enc;S.Base64url={stringify:function(h,w=!0){var _=h.words,g=h.sigBytes,v=w?this._safe_map:this._map;h.clamp();for(var u=[],d=0;d<g;d+=3)for(var s=_[d>>>2]>>>24-d%4*8&255,f=_[d+1>>>2]>>>24-(d+1)%4*8&255,B=_[d+2>>>2]>>>24-(d+2)%4*8&255,t=s<<16|f<<8|B,i=0;i<4&&d+i*.75<g;i++)u.push(v.charAt(t>>>6*(3-i)&63));var a=v.charAt(64);if(a)for(;u.length%4;)u.push(a);return u.join("")},parse:function(h,w=!0){var _=h.length,g=w?this._safe_map:this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var u=0;u<g.length;u++)v[g.charCodeAt(u)]=u}var d=g.charAt(64);if(d){var s=h.indexOf(d);s!==-1&&(_=s)}return C(h,_,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function C(h,w,_){for(var g=[],v=0,u=0;u<w;u++)if(u%4){var d=_[h.charCodeAt(u-1)]<<u%4*2,s=_[h.charCodeAt(u)]>>>6-u%4*2,f=d|s;g[v>>>2]|=f<<24-v%4*8,v++}return c.create(g,v)}}(),n.enc.Base64url})})(St);var J={},Mt={get exports(){return J},set exports(r){J=r}};(function(r,e){(function(n,o){r.exports=o(Y())})(T,function(n){return function(o){var p=n,c=p.lib,S=c.WordArray,C=c.Hasher,h=p.algo,w=[],_=[];(function(){function u(B){for(var t=o.sqrt(B),i=2;i<=t;i++)if(!(B%i))return!1;return!0}function d(B){return(B-(B|0))*4294967296|0}for(var s=2,f=0;f<64;)u(s)&&(f<8&&(w[f]=d(o.pow(s,1/2))),_[f]=d(o.pow(s,1/3)),f++),s++})();var g=[],v=h.SHA256=C.extend({_doReset:function(){this._hash=new S.init(w.slice(0))},_doProcessBlock:function(u,d){for(var s=this._hash.words,f=s[0],B=s[1],t=s[2],i=s[3],a=s[4],l=s[5],y=s[6],m=s[7],b=0;b<64;b++){if(b<16)g[b]=u[d+b]|0;else{var x=g[b-15],j=(x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3,M=g[b-2],$=(M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10;g[b]=j+g[b-7]+$+g[b-16]}var nt=a&l^~a&y,rt=f&B^f&t^B&t,it=(f<<30|f>>>2)^(f<<19|f>>>13)^(f<<10|f>>>22),ot=(a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25),K=m+ot+nt+_[b]+g[b],st=it+rt;m=y,y=l,l=a,a=i+K|0,i=t,t=B,B=f,f=K+st|0}s[0]=s[0]+f|0,s[1]=s[1]+B|0,s[2]=s[2]+t|0,s[3]=s[3]+i|0,s[4]=s[4]+a|0,s[5]=s[5]+l|0,s[6]=s[6]+y|0,s[7]=s[7]+m|0},_doFinalize:function(){var u=this._data,d=u.words,s=this._nDataBytes*8,f=u.sigBytes*8;return d[f>>>5]|=128<<24-f%32,d[(f+64>>>9<<4)+14]=o.floor(s/4294967296),d[(f+64>>>9<<4)+15]=s,u.sigBytes=d.length*4,this._process(),this._hash},clone:function(){var u=C.clone.call(this);return u._hash=this._hash.clone(),u}});p.SHA256=C._createHelper(v),p.HmacSHA256=C._createHmacHelper(v)}(Math),n.SHA256})})(Mt);const jt=()=>{let r="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.length;let o=0;for(;o<128;)r+=e.charAt(Math.floor(Math.random()*n)),o+=1;return r},Rt=async(r,e,n,o)=>{const p=await fetch(`${r}`,{method:e,headers:o,body:n});let c;const S=await p.text();try{c=JSON.parse(S)}catch{throw S}if(!p.ok)throw c;return c},I=r=>{var e;return r&&((e=Object.entries(r))==null?void 0:e.length)>0?Object.entries(r).map(([n,o])=>`${encodeURIComponent(n)}=${encodeURIComponent(o)}`).join("&"):""},Tt={environments:{production:{api:"https://api.monerium.app",web:"https://monerium.app"},sandbox:{api:"https://api.monerium.dev",web:"https://sandbox.monerium.dev"}}};var P,z,O,A,V,G,D,tt,F,et;class $t{constructor(e="sandbox"){R(this,O),R(this,V),R(this,D),R(this,F),R(this,P,void 0),R(this,z,void 0),U(this,"codeVerifier"),U(this,"bearerProfile"),U(this,"pkceRequest",n=>this.getAuthFlowURI(n)),X(this,P,Tt.environments[e])}async auth(e){let n;if(k(this,V,G).call(this,e))n={...e,grant_type:"authorization_code"};else if(k(this,D,tt).call(this,e))n={...e,grant_type:"refresh_token"};else if(k(this,F,et).call(this,e))n={...e,grant_type:"client_credentials"};else throw new Error("Authentication method could not be detected.");return this.bearerProfile=await k(this,O,A).call(this,"post","auth/token",n,!0),X(this,z,`Bearer ${this.bearerProfile.access_token}`),this.bearerProfile}getAuthFlowURI(e){this.codeVerifier=jt();const n=W.stringify(J(this.codeVerifier)),o={...e,client_id:e==null?void 0:e.client_id,code_challenge:n,code_challenge_method:"S256",response_type:"code"};return`${H(this,P).api}/auth?${I(o)}`}getAuthContext(){return k(this,O,A).call(this,"get","auth/context")}getProfile(e){return k(this,O,A).call(this,"get",`profiles/${e}`)}getBalances(e){return e?k(this,O,A).call(this,"get",`profiles/${e}/balances`):k(this,O,A).call(this,"get","balances")}getOrders(e){const n=I(e);return k(this,O,A).call(this,"get",`orders?${n}`)}getOrder(e){return k(this,O,A).call(this,"get",`orders/${e}`)}getTokens(){return k(this,O,A).call(this,"get","tokens")}linkAddress(e,n){return k(this,O,A).call(this,"post",`profiles/${e}/addresses`,JSON.stringify(n))}placeOrder(e,n){const o={...e,kind:"redeem",currency:"eur"};return n?k(this,O,A).call(this,"post",`profiles/${n}/orders`,JSON.stringify(o)):k(this,O,A).call(this,"post","orders",JSON.stringify(o))}uploadSupportingDocument(e){const n=I(e);return k(this,O,A).call(this,"post","files/supporting-document",n,!0)}}P=new WeakMap,z=new WeakMap,O=new WeakSet,A=async function(r,e,n,o){return Rt(`${H(this,P).api}/${e}`,r,o?I(n):n,{Authorization:H(this,z)||"","Content-Type":`application/${o?"x-www-form-urlencoded":"json"}`})},V=new WeakSet,G=function(r){return r.code!=null},D=new WeakSet,tt=function(r){return r.refresh_token!=null},F=new WeakSet,et=function(r){return r.client_secret!=null};function Pt(r){let e,n="connectMonerium",o,p=JSON.stringify(r[0])+"",c,S,C;return{c(){e=ct("button"),e.textContent=n,o=lt(),c=ut(p),this.h()},l(h){e=ht(h,"BUTTON",{class:!0,"data-svelte-h":!0}),ft(e)!=="svelte-14jl4as"&&(e.textContent=n),o=pt(h),c=dt(h,p),this.h()},h(){gt(e,"class","btn variant-filled")},m(h,w){E(h,e,w),E(h,o,w),E(h,c,w),S||(C=yt(e,"click",r[2]),S=!0)},p(h,[w]){w&1&&p!==(p=JSON.stringify(h[0])+"")&&wt(c,p)},i:Q,o:Q,d(h){h&&(N(e),N(o),N(c)),S=!1,C()}}}function It(r,e,n){let o;async function p(){const S=new $t("sandbox");await S.auth({client_id:{}.VITE_MONERIUM_CLIENT,client_secret:{}.VITE_MONERIUM_SECRET}),n(0,o=await S.getAuthContext()),console.log("authcontext: "+JSON.stringify(o))}return[o,p,()=>p()]}class Nt extends vt{constructor(e){super(),mt(this,e,It,Pt,at,{})}}export{Nt as default};
